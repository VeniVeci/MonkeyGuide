# 怎么进行代码梳理比较高效



### 代码也会发霉

会发霉的不只是食物，代码也会。我们通常称为腐化。腐化的过程每天都在发生，一个紧急需求，一个新同事加入，一个变态的问题修复，一个共建项目，等等。腐化，是永远无法避免的，就像宇宙的熵增不可逆一样。面对腐化，架构师往往会加上一个防腐层。如果你的系统还没有防腐层，赶紧考虑考虑。即便有防腐层，也招架不住岁月的摧残，就像头上那日渐稀少的秀发，这就是命啊。

所以，我们需要重构。逆熵增需要做大量的功，要对混乱的代码重新梳理，使其恢复条理清晰、架构分明的优良状态。




### 梳理，还是梳理

重构前花大量时间对历史逻辑做梳理，而且要细致。古人曰“工欲善其事，必先利其器”。梳理好的逻辑就是重构的指路明灯。哪些要丢弃，哪些要优化，哪些要重构，哪些要产品重新定，哪些是风险点，在梳理好后就基本明了了。梳理带来的不只是逻辑的浮现，可能还有架构的方向。通过梳理，能够明确发现业务逻辑，甚至可以定义出新的领域模型、值、事件等。想想银河纪元时代，拿着银河系实时星图作战，就知道梳理有多重要了。




### 架构，以终为始

既然做重构了，架构方面就要好好设计。尽量摒弃错综复杂的历史逻辑，设计新的架构方案。以提高研发效率、降低维护成本为最终目标，所有的重构设计都围绕着这个目标展开。没有什么是不能改的，如果不能，那就加两个更牛逼的程序员。如果重构后还保留一坨屎一样的遗留代码，真不知道重构的意义是什么。重构就是要以终为始，在新的架构设计中，让遗留代码重新投胎以获得新的生命。



### 改善，代码重构

优秀的程序员是需要不定期对已有代码做或多或少的重构的。在《重构 改善既有代码的设计》一书中，作者已经给了很多重构的具体方法。重复代码抽出、过长函数拆分、模型重新设计、封装字段、封装集合、以State/Strategy取代类型码、方法移动位置等诸多技巧，这里就不展开了。我觉得每个程序员都应该好好学习下这本书，然后深入实践下代码级重构。正如书评所说“虽不应翻着重构手册干活，但需对本书中提到的70多个重构方法成竹在胸”。
